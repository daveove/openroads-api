postgres:
  image: opengovt/openroads-db
  ports:
    - "5432:5432"

test:
  build: .
  command: ./wait_test.sh
  environment:
    - OR_ENV=docker
    - WAIT_COMMAND= [ $$(psql postgres://osm:password@postgres:5432/api06_test -c "select count(*) from admin_boundaries" | head -n 3 | tail -n 1) -gt 0 ]
    - WAIT_SLEEP=2
    - WAIT_START_CMD=npm test
  links:
    - postgres:postgres